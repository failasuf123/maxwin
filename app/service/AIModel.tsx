import { GoogleGenerativeAI } from "@google/generative-ai";

  
const apiKey = process.env.NEXT_PUBLIC_GOOGLE_GEMINI_AI_API_KEY;

if (!apiKey) {
  throw new Error("API key is missing. Please check your environment variables.");
}

const genAI = new GoogleGenerativeAI(apiKey);
  // const model = genAI.getGenerativeModel({
  //   model: "gemini-1.5-flash",
  // });

  const model = genAI.getGenerativeModel({
    model: "gemini-2.0-flash-lite-preview-02-05",
  });
  
  const generationConfig = {
    temperature: 1.05,
    topP: 0.95,
    topK: 64,
    maxOutputTokens: 8192,
    responseMimeType: "application/json",
  };
  
  export  const chatSession = model.startChat({
      generationConfig,
      // history: [
      //   {
      //     role: "user",
      //     parts: [
      //       {text: "Generate Travel Plan for Location: Jakarta, for 3 Days for Couple with a Cheap budget. Give me a Hotels options list with HotelName, Hotel address, Price, hotel image url, geo coordinates, rating, descriptions and suggest itinerary with placeName, Place Details, Place Image Url, Geo Coordinates, ticket Pricing, Rating, Time travel each of the location for 3 days with each day plan with best time to with format startTime - endTime visit in JSON format."},
      //     ],
      //   },
      //   {
      //     role: "model",
      //     parts: [
      //       {text: "```json\n{\n  \"hotelOptions\": [\n    {\n      \"hotelName\": \"Capsule Hotel Bobobox\",\n      \"hotelAddress\": \"Jl. Wahid Hasyim No. 118, Menteng, Central Jakarta City, Jakarta 10310, Indonesia\",\n      \"price\": \"$20-$30 per night\",\n      \"hotelImageUrl\": \"https://www.booking.com/hotel/id/bobobox-wahid-hasyim.html\",\n      \"geoCoordinates\": \"-6.197000, 106.829100\",\n      \"rating\": 4.5,\n      \"description\": \"Modern capsule hotel with shared bathrooms and a communal lounge. Ideal for budget travelers who value cleanliness and convenience.\"\n    },\n    {\n      \"hotelName\": \"RedDoorz Plus @ Cikini\",\n      \"hotelAddress\": \"Jl. Cikini Raya No. 94, Cikini, Menteng, Central Jakarta City, Jakarta 10330, Indonesia\",\n      \"price\": \"$15-$25 per night\",\n      \"hotelImageUrl\": \"https://www.reddoorz.com/hotels/indonesia/jakarta/reddoorz-plus-at-cikini\",\n      \"geoCoordinates\": \"-6.187700, 106.838500\",\n      \"rating\": 4.0,\n      \"description\": \"Simple and clean budget hotel with basic amenities. Located in a convenient area with easy access to public transportation.\"\n    },\n    {\n      \"hotelName\": \"OYO 171 Hotel 88 Thamrin\",\n      \"hotelAddress\": \"Jl. KH. Wahid Hasyim No. 117, Menteng, Central Jakarta City, Jakarta 10310, Indonesia\",\n      \"price\": \"$10-$20 per night\",\n      \"hotelImageUrl\": \"https://www.oyorooms.com/hotels/jakarta/oyo-171-hotel-88-thamrin-5717\",\n      \"geoCoordinates\": \"-6.197200, 106.829000\",\n      \"rating\": 3.5,\n      \"description\": \"Basic budget hotel with minimal amenities. Suitable for those on a very tight budget and prioritize location over luxury.\"\n    }\n  ],\n  \"itinerary\": {\n    \"day1\": {\n      \"name\": \"Exploring Old Town Charm\",\n      \"plan\": [\n        {\n          \"placeName\": \"Kota Tua (Old Town)\",\n          \"placeDetails\": \"Historic district with Dutch colonial architecture, museums, and a vibrant atmosphere.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=kota+tua+jakarta&tbm=isch\",\n          \"geoCoordinates\": \"-6.134000, 106.819000\",\n          \"ticketPricing\": \"Rp.0\",\n          \"rating\": 4.5,\n          \"timeTravel\": \"9:00 AM - 1:00 PM\"\n        },\n        {\n          \"placeName\": \"Museum Sejarah Jakarta (Jakarta History Museum)\",\n          \"placeDetails\": \"Learn about Jakarta's rich history and cultural heritage.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=museum+sejarah+jakarta&tbm=isch\",\n          \"geoCoordinates\": \"-6.133600, 106.820500\",\n          \"ticketPricing\": \"Rp. 5,000 (approx. $0.35)\",\n          \"rating\": 4.0,\n          \"timeTravel\": \"1:30 PM - 3:00 PM\"\n        },\n        {\n          \"placeName\": \"Manneken Pis (Jakarta Version)\",\n          \"placeDetails\": \"Small statue of a boy peeing, a playful landmark in the Old Town.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=manneken+pis+jakarta&tbm=isch\",\n          \"geoCoordinates\": \"-6.135000, 106.821000\",\n          \"ticketPricing\": \"Rp.0\",\n          \"rating\": 3.5,\n          \"timeTravel\": \"3:30 PM - 4:00 PM\"\n        },\n        {\n          \"placeName\": \"Cafe Batavia\",\n          \"placeDetails\": \"Historic cafe with a colonial ambiance, perfect for a relaxing afternoon.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=cafe+batavia&tbm=isch\",\n          \"geoCoordinates\": \"-6.133800, 106.820000\",\n          \"ticketPricing\": \"No entry fee\",\n          \"rating\": 4.0,\n          \"timeTravel\": \"4:30 PM - 6:00 PM\"\n        }\n      ]\n    },\n    \"day2\": {\n      \"name\": \"Cultural Immersion\",\n      \"plan\": [\n        {\n          \"placeName\": \"Museum Nasional (National Museum of Indonesia)\",\n          \"placeDetails\": \"Discover Indonesian art, artifacts, and history.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=museum+nasional+indonesia&tbm=isch\",\n          \"geoCoordinates\": \"-6.175000, 106.824000\",\n          \"ticketPricing\": \"Rp. 10,000 (approx. $0.70)\",\n          \"rating\": 4.5,\n          \"timeTravel\": \"9:00 AM - 12:00 PM\"\n        },\n        {\n          \"placeName\": \"Istiqlal Mosque\",\n          \"placeDetails\": \"Magnificent mosque, the largest in Southeast Asia.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=istiqlal+mosque&tbm=isch\",\n          \"geoCoordinates\": \"-6.174400, 106.821400\",\n          \"ticketPricing\": \"Rp.0\",\n          \"rating\": 4.0,\n          \"timeTravel\": \"12:30 PM - 2:00 PM\"\n        },\n        {\n          \"placeName\": \"Taman Mini Indonesia Indah (TMII)\",\n          \"placeDetails\": \"Cultural park showcasing miniature versions of Indonesian provinces.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=taman+mini+indonesia+indah&tbm=isch\",\n          \"geoCoordinates\": \"-6.331600, 106.883200\",\n          \"ticketPricing\": \"Rp. 25,000 (approx. $1.75)\",\n          \"rating\": 4.0,\n          \"timeTravel\": \"2:30 PM - 6:00 PM\"\n        }\n      ]\n    },\n    \"day3\": {\n      \"name\": \"Modern Jakarta & Shopping\",\n      \"plan\": [\n        {\n          \"placeName\": \"Monas (National Monument)\",\n          \"placeDetails\": \"Iconic monument symbolizing Indonesia's independence.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=monas+jakarta&tbm=isch\",\n          \"geoCoordinates\": \"-6.175000, 106.824000\",\n          \"ticketPricing\": \"Rp. 15,000 (approx. $1.05)\",\n          \"rating\": 4.0,\n          \"timeTravel\": \"9:00 AM - 11:00 AM\"\n        },\n        {\n          \"placeName\": \"Grand Indonesia Shopping Mall\",\n          \"placeDetails\": \"Luxury shopping mall with international brands and entertainment options.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=grand+indonesia+shopping+mall&tbm=isch\",\n          \"geoCoordinates\": \"-6.180000, 106.824000\",\n          \"ticketPricing\": \"Rp.0\",\n          \"rating\": 4.0,\n          \"timeTravel\": \"11:30 AM - 3:00 PM\"\n        },\n        {\n          \"placeName\": \"Sarinah\",\n          \"placeDetails\": \"Historical department store with local and international brands.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=sarinah+jakarta&tbm=isch\",\n          \"geoCoordinates\": \"-6.178000, 106.826000\",\n          \"ticketPricing\": \"Rp.0\",\n          \"rating\": 3.5,\n          \"timeTravel\": \"3:30 PM - 5:00 PM\"\n        },\n        {\n          \"placeName\": \"Street Food Tour (Thamrin or Menteng area)\",\n          \"placeDetails\": \"Sample delicious street food and experience the local culinary scene.\",\n          \"placeImageUrl\": \"https://www.google.com/search?q=street+food+jakarta&tbm=isch\",\n          \"geoCoordinates\": \"-6.180000, 106.825000\",\n          \"ticketPricing\": \"Varies depending on food choices\",\n          \"rating\": 4.5,\n          \"timeTravel\": \"5:30 PM - 7:00 PM\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Explanation of the JSON format:**\n\n* **hotelOptions:** This section provides details of budget-friendly hotels in Jakarta. Each entry contains:\n    * **hotelName:** The name of the hotel.\n    * **hotelAddress:** The physical address.\n    * **price:** Estimated price range per night.\n    * **hotelImageUrl:** URL to an image of the hotel.\n    * **geoCoordinates:** Latitude and longitude for location on a map.\n    * **rating:** Average customer rating (out of 5).\n    * **description:** A brief summary of the hotel's features and target audience.\n\n* **itinerary:** This section outlines a 3-day itinerary for a couple, split into daily plans:\n    * **day1:**  \"Exploring Old Town Charm\" - focuses on historic sites and a relaxed atmosphere.\n    * **day2:**  \"Cultural Immersion\" - delves into Indonesian culture through museums and landmarks.\n    * **day3:**  \"Modern Jakarta & Shopping\" - explores contemporary Jakarta, including shopping malls and local street food.\n\n**Within each day's plan:**\n\n* **placeName:** The name of the location.\n* **placeDetails:** A brief description of the location's significance or attractions.\n* **placeImageUrl:** URL to an image representing the location.\n* **geoCoordinates:** Latitude and longitude for mapping.\n* **ticketPricing:** Estimated cost of entry (if applicable).\n* **rating:** Average user rating (if available).\n* **timeTravel:** Recommended time to spend at the location (based on a typical couple's pace).\n\n**Using the JSON:**\n\nThis JSON data can be used in various ways:\n\n* **Travel Planning Website/App:** Easily integrate this data into your interface to display hotel options, itinerary plans, and interactive maps.\n* **Custom Itinerary Generator:** Create a program that lets users select their interests, and the JSON data can be used to generate a customized itinerary.\n* **Data Analysis:** Extract insights from the data, such as popular attractions, average hotel prices, or travel trends.\n\n**Remember:** \n\n* This itinerary provides a general framework, and you can adjust it based on your specific interests and budget.\n* Prices are approximate and can vary depending on the time of year and booking platform.\n* Always research attractions and transportation options for the most up-to-date information.\n"},
      //     ],
      //   },
      // ],

      history: [
        {
          role: "user",
          parts: [
            {text: "Generate Travel Plan for Location: Bandung, for 3 Days for Couple with a Cheap budget. Give me a Hotels options list with HotelName, Hotel address, Price (estimation price in indonesian rupiah with integer data type), hotel image url, geo coordinates, rating, descriptions and suggest itinerary with placeName, Place Details, Place Image Url, Geo Coordinates, ticket Pricing  (estimation price in indonesian rupiah in integer data type), Rating, Time travel each of the location (with \"start time - end time\" format) for 3 days with each day plan with best time to visit in JSON format, make sure that all string atribut value in Indonesian language format.\n\n*   **hotelOptions:**\n    *   `hotelName` (string, nama hotel)\n    *   `hotelAddress` (string, alamat hotel)\n    *   `price` (integer, perkiraan harga per malam dalam Rupiah)\n    *   `hotelImageUrl` (string, URL gambar hotel)\n    *   `geoCoordinates` (string, koordinat geografis dalam format \"latitude,longitude\")\n    *   `rating` (float, rating hotel)\n    *   `description` (string, deskripsi hotel dalam Bahasa Indonesia)\n\n*   **itinerary:**\n    *   `day1`, `day2`, `day3` (objek, rencana perjalanan untuk setiap hari)\n        *   `theme` (string, tema hari, contoh: \"Wisata Alam\")\n        *   `plan` (array objek, daftar tempat yang dikunjungi)\n            *   `placeName` (string, nama tempat)\n            *   `placeDetails` (string, detail tempat dalam Bahasa Indonesia)\n            *   `placeImageUrl` (string, URL gambar tempat)\n            *   `geoCoordinates` (string, koordinat geografis dalam format \"latitude,longitude\")\n            *   `ticketPricing` (integer, perkiraan harga tiket masuk dalam Rupiah, 0 jika gratis)\n            *   `rating` (float, rating tempat)\n            *   `timeTravel` (string, waktu kunjungan dalam format \"HH:MM - HH:MM\")"},
          ],
        },
        {
          role: "model",
          parts: [
            {text: "```json\n{\n  \"hotelOptions\": [\n    {\n      \"hotelName\": \"RedDoorz near Trans Studio Bandung\",\n      \"hotelAddress\": \"Jl. Jend. Gatot Subroto No.283, Cibangkong, Kec. Batununggal, Kota Bandung, Jawa Barat 40273\",\n      \"price\": 150000,\n      \"hotelImageUrl\": \"https://ik.imagekit.io/tvlk/hotel/aio/default/5040197.jpg?tr=w-300,h-300,q-50\",\n      \"geoCoordinates\": \"-6.9261,107.6434\",\n      \"rating\": 3.8,\n      \"description\": \"Hotel budget yang terletak dekat dengan Trans Studio Bandung, menawarkan kamar yang nyaman dengan harga terjangkau.\"\n    },\n    {\n      \"hotelName\": \"GH Universal Hotel Bandung\",\n      \"hotelAddress\": \"Jl. Setiabudi No.376, Isola, Kec. Sukasari, Kota Bandung, Jawa Barat 40154\",\n      \"price\": 250000,\n      \"hotelImageUrl\": \"https://cf.bstatic.com/xdata/images/hotel/square600/40295073.jpg?k=df0f3c09a5937f83914a7264747275773d6140b26628e71c4d3757f7e01b8013&o=&s=1\",\n      \"geoCoordinates\": \"-6.8798,107.5832\",\n      \"rating\": 4.0,\n      \"description\": \"Hotel yang menawarkan kamar modern dengan kolam renang dan restoran. Terletak di kawasan Setiabudi yang strategis.\"\n    },\n    {\n      \"hotelName\": \"OYO 1010 Dago's Hill\",\n      \"hotelAddress\": \"Jl. Ir. H. Djuanda No.362, Dago, Coblong, Kota Bandung, Jawa Barat 40135\",\n      \"price\": 180000,\n      \"hotelImageUrl\": \"https://dynamic-media-cdn.tripadvisor.com/media/photo-s/15/81/09/e5/oyo-1010-dago-s-hill.jpg?w=1200&h=-1&s=1\",\n      \"geoCoordinates\": \"-6.8895,107.6132\",\n      \"rating\": 3.5,\n      \"description\": \"Hotel budget di kawasan Dago, dekat dengan berbagai tempat wisata dan kuliner.\"\n    }\n  ],\n  \"itinerary\": {\n    \"day1\": {\n      \"theme\": \"Mengunjungi Keindahan Alam Bandung\",\n      \"plan\": [\n        {\n          \"placeName\": \"Kawah Putih\",\n          \"placeDetails\": \"Kawah Putih adalah danau kawah vulkanik dengan air berwarna putih kehijauan yang memukau. Nikmati pemandangan yang indah dan udara yang sejuk.\",\n          \"placeImageUrl\": \"https://www.nativeindonesia.com/wp-content/uploads/2019/12/Kawah-Putih-Bandung-1.jpg\",\n          \"geoCoordinates\": \"-7.1932,107.3043\",\n          \"ticketPricing\": 30000,\n          \"rating\": 4.5,\n          \"timeTravel\": \"08:00 - 12:00\"\n        },\n        {\n          \"placeName\": \"Situ Patenggang\",\n          \"placeDetails\": \"Danau yang indah dengan suasana yang tenang dan dikelilingi oleh perkebunan teh. Anda dapat menyewa perahu untuk berkeliling danau.\",\n          \"placeImageUrl\": \"https://www.jejakpiknik.com/wp-content/uploads/2018/08/situ-patenggang-bandung.jpg\",\n          \"geoCoordinates\": \"-7.1725,107.3176\",\n          \"ticketPricing\": 25000,\n          \"rating\": 4.2,\n          \"timeTravel\": \"13:00 - 16:00\"\n        }\n      ]\n    },\n    \"day2\": {\n      \"theme\": \"Petualangan Kota & Belanja\",\n      \"plan\": [\n        {\n          \"placeName\": \"Trans Studio Bandung\",\n          \"placeDetails\": \"Taman hiburan dalam ruangan dengan berbagai wahana dan atraksi seru untuk semua usia. Cocok untuk pasangan yang suka tantangan dan kesenangan.\",\n          \"placeImageUrl\": \"https://lh3.googleusercontent.com/proxy/Vd662n8xH8L-r7YV_X1zX9n_6074b76TjL088h0HnU_Qy8K2t6G5L-7lH5jL20zQhR-x_310c8T1bI2WpL737x2-o8mN_5H-b16j26d7h-3_x9jQ=w1200-h630-p-k-no-nu\",\n          \"geoCoordinates\": \"-6.9265,107.6403\",\n          \"ticketPricing\": 280000,\n          \"rating\": 4.0,\n          \"timeTravel\": \"09:00 - 17:00\"\n        },\n         {\n          \"placeName\": \"Jalan Cibaduyut\",\n          \"placeDetails\": \"Pusatnya sepatu dan produk kulit lainnya dengan harga yang terjangkau. Cocok untuk berburu oleh-oleh.\",\n          \"placeImageUrl\": \"https://www.bandungtour.com/wp-content/uploads/2015/03/cibaduyut.jpg\",\n          \"geoCoordinates\": \"-6.9419,107.5986\",\n          \"ticketPricing\": 0,\n          \"rating\": 3.8,\n          \"timeTravel\": \"17:30 - 20:00\"\n        }\n      ]\n    },\n    \"day3\": {\n      \"theme\": \"Kuliner & Wisata Sejarah\",\n      \"plan\": [\n        {\n          \"placeName\": \"Gedung Sate\",\n          \"placeDetails\": \"Bangunan bersejarah ikonik Bandung dengan arsitektur yang unik. Anda dapat berfoto dan menikmati keindahan gedung.\",\n          \"placeImageUrl\": \"https://awsimages.detik.net.id/community/media/visual/2023/08/10/gedung-sate-bandung_169.jpeg?w=1200\",\n          \"geoCoordinates\": \"-6.9013,107.6191\",\n          \"ticketPricing\": 0,\n          \"rating\": 4.3,\n          \"timeTravel\": \"08:00 - 09:30\"\n        },\n        {\n          \"placeName\": \"Braga Street\",\n          \"placeDetails\": \"Jalan bersejarah dengan bangunan-bangunan kuno yang indah. Nikmati suasana kota tua sambil berjalan-jalan.\",\n          \"placeImageUrl\": \"https://www.bandungtour.com/wp-content/uploads/2019/10/braga-bandung.jpg\",\n          \"geoCoordinates\": \"-6.9165,107.6072\",\n          \"ticketPricing\": 0,\n          \"rating\": 4.1,\n          \"timeTravel\": \"09:30 - 11:00\"\n        },\n        {\n           \"placeName\": \"Rumah Makan Nasi Bancakan\",\n           \"placeDetails\": \"Restoran yang menyajikan makanan khas Sunda dengan konsep prasmanan. Cocok untuk mencoba berbagai hidangan lezat.\",\n           \"placeImageUrl\": \"https://arsitagx-master.s3.ap-southeast-1.amazonaws.com/img_medium/3963/4471/31875/photo-exterior-rumah-makan-nasi-bancakan.jpeg\",\n           \"geoCoordinates\": \"-6.9174, 107.6106\",\n           \"ticketPricing\": 50000,\n           \"rating\": 4.4,\n           \"timeTravel\": \"11:30 - 13:00\"\n         },\n        {\n          \"placeName\": \"Paris Van Java (PVJ)\",\n          \"placeDetails\": \"Pusat perbelanjaan modern dengan berbagai toko dan restoran. Cocok untuk bersantai dan berbelanja oleh-oleh terakhir.\",\n          \"placeImageUrl\": \"https://www.bandungtour.com/wp-content/uploads/2015/05/paris-van-java.jpg\",\n          \"geoCoordinates\": \"-6.8964,107.6008\",\n          \"ticketPricing\": 0,\n          \"rating\": 4.2,\n          \"timeTravel\": \"13:30 - 17:00\"\n        }\n      ]\n    }\n  }\n}\n```"},
          ],
        },
      ],
    });
  

